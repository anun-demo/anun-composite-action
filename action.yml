name: 'ANUN'
description: 'ANUN'
inputs:
  package-url:  # id of input
    description: 'Package url'
    required: true
    default: 'NA'
  installer-url:
    description: 'Install url'
    required: true
    default: 'NA'
  tenant-id:
    description: 'Tenant ID'
    required: true
    default: 'NA'
  secret:
    description: 'Secret'
    required: true
    default: 'NA'
  host:
    description: 'ANUN host'
    required: false
    default: 'api.anun-dev.cloud'
runs:
  using: "composite"
  steps:
    - run: |
       sudo apt-get update && sudo apt-get install curl wget strace
       echo "ANUN_TENANT=${{ inputs.tenant-id }}" >> $GITHUB_ENV
       echo "ANUN_SECRET=${{ inputs.secret }}" >> $GITHUB_ENV
       echo "ANUN_SOURCE=github" >> $GITHUB_ENV
       echo "ANUN_HOST=${{ inputs.host }}" >> $GITHUB_ENV
       sudo curl -s ${{ inputs.installer-url }} | sudo bash -s "${{ inputs.package-url }}"
       sudo /anun-tracer/anun -p $(pgrep Runner.Worker) &
       sleep 5
      shell: bash
       
